<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN 2.0//EN"
    "http://www.springframework.org/dtd/spring-beans-2.0.dtd">

<beans>
 
  <bean
    id="eCommonsAuthenticationClient"
    class="edu.harvard.med.authentication.eCommons.ECommonsAuthenticationClient">
    <description>Client for an HMS network service that authenticates a given eCommons ID / password pair.</description>
    <!-- requesting application's name; arbitrary, for server auditing only -->
    <constructor-arg index="0" value="Screensaver1"/>
    <!-- the HMS-assigned "issuer" ID; must be approved -->
    <constructor-arg index="1" value="Orchestra_ATTR_CLIENT"/>
    <!-- the URL of the eCommons authentication server -->
    <constructor-arg index="2" value="https://authenticate.med.harvard.edu/wsAuthenticate.asp"/>
  </bean>

  <bean
    id="screensaverLoginModule"
    class="edu.harvard.med.screensaver.ui.authentication.ScreensaverLoginModule"
    scope="prototype">
    <description>JAAS LoginModule implementation that can be used to authenticate and authorize a user.  In our case, the Tomcat app server will make calls to this bean.  Maintains state between method calls, so cannot be a singleton.</description>
    <property name="dao" ref="dao"/>
    <property name="authenticationClient" ref="eCommonsAuthenticationClient"/>
  </bean>
  
  <bean
    id="loginModuleFactory" 
    class="edu.harvard.med.screensaver.ui.authentication.LoginModuleFactoryImpl"
    init-method="initialize">
  </bean>

  <bean 
    id="screenResultParser"
    class="edu.harvard.med.screensaver.io.screenresults.ScreenResultParser"
    scope="prototype">
    <constructor-arg index="0" ref="dao"/>
  </bean>

  <!-- TODO: place this in a spring-context-testing.xml file, or something similar -->  
  <bean 
    id="mockScreenResultParser"
    class="edu.harvard.med.screensaver.io.screenresults.ScreenResultParser"
    scope="prototype">
    <description>A ScreenResultParser that does not need access to a database.  Used for testing.</description>
    <constructor-arg index="0" >
      <bean class="edu.harvard.med.screensaver.io.screenresults.MockDaoForScreenResultImporter"/>
    </constructor-arg>
  </bean>

  <bean
    id="screenResultImporter"
    class="edu.harvard.med.screensaver.ui.screenresults.ScreenResultImporter">
    <description>Screen Result Importer</description>
  </bean>

  <bean 
    id="screenResultExporter"
    class="edu.harvard.med.screensaver.io.screenresults.ScreenResultExporter"
    scope="singleton">
  </bean>

  <bean 
    id="compoundLibraryContentsParser"
    class="edu.harvard.med.screensaver.io.libraries.compound.SDFileCompoundLibraryContentsParser"
    scope="prototype"
  >
    <constructor-arg ref="dao"/>
  </bean>

  <bean 
    id="rnaiLibraryContentsParser"
    class="edu.harvard.med.screensaver.io.libraries.rnai.RNAiLibraryContentsParser"
    scope="prototype"
  >
    <constructor-arg ref="dao"/>
  </bean>

  <bean 
    id="screenDBDataImporter"
    class="edu.harvard.med.screensaver.db.screendb.ScreenDBDataImporter"
    scope="singleton">
    <constructor-arg ref="dao"/>
  </bean>

  <bean 
    id="bulkCompoundLibraryLoader"
    class="edu.harvard.med.screensaver.io.libraries.compound.BulkCompoundLibraryLoader"
    scope="singleton">
    <constructor-arg ref="unrestrictedDao"/>
    <constructor-arg ref="compoundLibraryContentsParser"/>
  </bean>
  
  <bean 
    id="bulkRNAiLibraryLoader"
    class="edu.harvard.med.screensaver.io.libraries.rnai.BulkRNAiLibraryLoader"
    scope="singleton">
    <constructor-arg ref="unrestrictedDao"/>
    <constructor-arg ref="rnaiLibraryContentsParser"/>
  </bean>
  
  <bean 
    id="bulkScreenResultImporter"
    class="edu.harvard.med.screensaver.io.screenresults.BulkScreenResultImporter"
    scope="singleton">
    <constructor-arg>
     <bean
      class="edu.harvard.med.screensaver.io.screenresults.ScreenResultParser">
      <constructor-arg ref="unrestrictedDao" />
     </bean>
    </constructor-arg>
    <constructor-arg ref="unrestrictedDao"/>
    <constructor-arg ref="hibernateTemplate"/>
  </bean>
  
</beans>
