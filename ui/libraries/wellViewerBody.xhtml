<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:t="http://myfaces.apache.org/tomahawk"
  xmlns:s="http://myfaces.apache.org/sandbox"
  xmlns:ss="http://screensaver.med.harvard.edu/ui">

<ui:composition>
<!-- 
  <ss:nameValueTable id="wellInfo" value="#{wellViewer.nameValueTable}" />
-->
  <h:form>
     <t:panelGrid id="wellInfoPropertiesPanel" columns="2"
      columnClasses="propertyLabelColumn,column"
      styleClass="layoutPanel">

       <ss:property id="plateNumber" label="Plate" 
         type="Text" 
         description="The number of the plate the well is located on" 
         value="#{wellViewer.entity.plateNumber}">
       </ss:property>
   
       <ss:property id="well" label="Well" 
         type="Text" 
         description="The plate coordinates of the well" 
         value="#{wellViewer.entity.wellName}">
       </ss:property>
   
       <ss:property id="library" label="Library"
         description="The library containing the well" >
         <ui:define name="data">
           <ss:entityLink
             entity="#{wellViewer.entity.library}"
             property="libraryName"
             viewer="#{libraryViewer}" />
         </ui:define>
       </ss:property>
       
       <ss:property id="screenType" label="Screen Type" 
         type="Text" 
         description="The library screen type" 
         value="#{wellViewer.entity.library.screenType}">
       </ss:property>

       <ss:property id="libraryWellType" label="Library Well Type" 
         type="Text" 
         description="The type of well, e.g., 'Experimental', 'Control', 'Empty', etc." 
         value="#{wellViewer.entity.libraryWellType}">
       </ss:property>

       <ss:property id="facilityId" label="Facility Identifier" 
         type="Text" 
         description="An alternate identifier assigned by the facility to identify this well" 
         value="#{wellViewer.entity.facilityId}">
       </ss:property>

       <ss:property id="vendorReagentId" label="Vendor Reagent Identifier" 
         type="Text" rendered="#{! empty wellViewer.versionedReagent}" 
         description="The vendor-assigned reagent identifier provided (e.g., catalog number; reorder number)" 
         value="#{wellViewer.versionedReagent.vendorId}">
       </ss:property>

       <ss:property id="deprecated" label="Deprecated" 
         type="Text" rendered="#{wellViewer.entity.deprecated}" 
         description="Why the well is deprecated" 
         value="#{wellViewer.entity.deprecationActivity.comments}">
       </ss:property>
       
       <ss:property id="libraryContentsVersion" label="Library Contents Version" 
         type="Text" rendered="#{wellViewer.unrestrictedReagent}"
         description="The reagent's library contents version" 
         value="#{wellViewer.versionedReagent.libraryContentsVersion.versionNumber}">
       </ss:property>

       <ss:property id="sequence" label="Sequence" 
         type="Text" rendered="#{wellViewer.allowedAccessToSilencingReagentSequence}"
         description="The nucleotide sequence of the silencing reagent" 
         value="#{wellViewer.versionedReagent.sequence}">
       </ss:property>

       <ss:property id="geneName" label="Gene Name" 
         type="Text" rendered="#{wellViewer.allowedAccessToSilencingReagent}"
         description="The name of the gene, as labelled in EntrezGene" 
         value="#{wellViewer.versionedReagent.facilityGene.geneName}">
       </ss:property>

       <ss:property id="entrezGeneId" label="EntrezGene ID" 
         type="Link" rendered="#{wellViewer.allowedAccessToSilencingReagent}"
         description="The EntrezGene ID, a.k.a. Locus ID" 
         value="#{wellViewer.versionedReagent.facilityGene.entrezgeneId}"
         linkValue="#{wellViewer.entrezgeneIdUrlPrefix}#{wellViewer.versionedReagent.facilityGene.entrezgeneId}">
       </ss:property>
       
       <ss:property id="entrezGeneSymbols" label="EntrezGene Symbol" 
         type="List" rendered="#{wellViewer.allowedAccessToSilencingReagent}"
         description="The EntrezGene Gene Symbols" 
         value="#{wellViewer.versionedReagent.facilityGene.entrezgeneSymbols}">
       </ss:property>
       
       <ss:property id="genBankAccessionNumbers" label="GenBank Accession Numbers" 
         type="ListOfLinks" rendered="#{wellViewer.allowedAccessToSilencingReagent}"
         description="The GenBank Accession Numbers for the gene" 
         value="#{wellViewer.versionedReagent.facilityGene.genbankAccessionNumbers}"
         linkPrefix="#{wellViewer.genbankAccessionNumberUrlPrefix}" >
       </ss:property>
       
       <ss:property id="speciesName" label="Species Name" 
         type="Text" rendered="#{wellViewer.allowedAccessToSilencingReagent}"
         description="The species this gene is found in" 
         value="#{wellViewer.versionedReagent.facilityGene.speciesName}">
       </ss:property>
        
       <!-- Small Molecule Reagent stuff -->
       <ss:property id="compoundImage" label="Structure"
         description="A 2D structure image of the compound"
         rendered="#{wellViewer.allowedAccessToSmallMoleculeReagent}" >
         <ui:define name="data">
           <t:graphicImage url="#{wellViewer.compoundImageUrl}"
             rendered="#{wellViewer.allowedAccessToSmallMoleculeReagent}" style="float: left;">
           </t:graphicImage>
         </ui:define>
       </ss:property>
              
       <ss:property id="smiles" label="Smiles" 
         type="Text" rendered="#{wellViewer.allowedAccessToSmallMoleculeReagent}"
         description="The SMILES string for the compound" 
         value="#{wellViewer.versionedReagent.smiles}">
       </ss:property>
              
       <ss:property id="inchi" label="Inchi" 
         type="Text" rendered="#{wellViewer.allowedAccessToSmallMoleculeReagent}"
         description="The InChI string for the compound" 
         value="#{wellViewer.versionedReagent.inchi}">
       </ss:property>

       <ss:property id="compoundNames" label="Compound Names" 
         type="List" rendered="#{wellViewer.allowedAccessToSmallMoleculeReagent}"
         description="The various names the compound goes by" 
         value="#{wellViewer.versionedReagent.compoundNames}">
       </ss:property>       

       <ss:property id="molecularMass" label="Molecular Mass" 
         type="Text" rendered="#{wellViewer.allowedAccessToSmallMoleculeReagent}"
         description="The molecular mass for the compound" 
         value="#{wellViewer.versionedReagent.molecularMass}">
       </ss:property>
       
       <ss:property id="molecularWeight" label="Molecular Weight" 
         type="Text" rendered="#{wellViewer.allowedAccessToSmallMoleculeReagent}"
         description="The molecular weight for the compound" 
         value="#{wellViewer.versionedReagent.molecularWeight}" >
       </ss:property>    
  
       <ss:property id="molecularFormula" label="Molecular Formula" 
         type="Text" rendered="#{wellViewer.allowedAccessToSmallMoleculeReagent}"
         description="The molecular formula for the compound" 
         value="#{wellViewer.compoundMolecularFormula}" escape="false">
       </ss:property>

       <ss:property id="pubchemCids" label="PubChem CIDs" 
         type="ListOfLinks" rendered="#{wellViewer.allowedAccessToSmallMoleculeReagent}"
         description="The PubChem Compound Identifiers" 
         value="#{wellViewer.versionedReagent.pubchemCids}"
         linkPrefix="#{wellViewer.pubchemCidUrlPrefix}" >
       </ss:property>
       
       <ss:property id="chembankIds" label="ChemBank IDs" 
         type="ListOfLinks" rendered="#{wellViewer.allowedAccessToSmallMoleculeReagent}"
         description="The ChemBank IDs for the compound" 
         value="#{wellViewer.versionedReagent.chembankIds}"
         linkPrefix="#{wellViewer.chembankIdUrlPrefix}" >
       </ss:property>
       
       </t:panelGrid>  
     </h:form>

  <t:panelGrid style="margin-top: 10px;">
    <t:panelGroup
      rendered="#{wellViewer.entity.library.reagentType.simpleName == 'SmallMoleculeReagent' &amp;&amp; !empty wellViewer.versionedReagent &amp;&amp; !empty wellViewer.versionedReagent.molfile}">
      <h:form id="wellContentsDownloadForm">
        <h:commandButton value="Download SD File"
          action="#{wellViewer.downloadSDFile}" styleClass="command"
          title="Download the contents of the well as an SD File" />
      </h:form>
    </t:panelGroup>
    <t:panelGroup rendered="#{! empty wellViewerSpecialMessage}"
      style="color: fuchsia; font-size: small; margin-top: 10px;">
      <t:outputText value="#{wellViewerSpecialMessage}" />
    </t:panelGroup>
  </t:panelGrid>

  <h:form id="panelsForm">
    <ss:collapsiblePanel id="duplexWellsPanel"
      isCollapsed="#{wellViewer.isPanelCollapsedMap['duplexWells']}"
      rendered="#{wellViewer.duplexWellsDataModel.rowCount > 0}"
      label="Duplex Wells">
      <ui:define name="content">
        <t:dataTable id="duplexWellsTable" var="well"
          value="#{wellViewer.duplexWellsDataModel}"
          styleClass="standardTable" columnClasses="column"
          rowClasses="row1,row2" headerClass="tableHeader">
          <t:column>
            <f:facet name="header">
              <t:outputText value="Well" />
            </f:facet>
            <ss:entityLink id="wellEntity" entity="#{well}"
              viewer="#{wellViewer}" />
          </t:column>
          <t:column>
            <f:facet name="header">
              <t:outputText value="Library Name" />
            </f:facet>
            <ss:entityLink id="libraryEntity" entity="#{well.library}"
              viewer="#{libraryViewer}" property="libraryName" />
          </t:column>
          <t:column>
            <f:facet name="header">
              <t:outputText value="Vendor Reagent Identifier" />
            </f:facet>
            <t:outputText value="#{well.latestReleasedReagent.vendorId}" />
          </t:column>
          <t:column rendered="#{wellViewer.allowedAccessToSilencingReagentSequence}">
            <f:facet name="header">
              <t:outputText value="Sequence" />
            </f:facet>
            <t:outputText value="#{well.latestReleasedReagent.sequence}" />
          </t:column>
        </t:dataTable>
        <!-- h:commandButton value="Browse..."
          action="#{wellViewer.browseDuplexWells}" styleClass="command"
          rendered="#{wellViewer.duplexWellsDataModel.rowCount > 0}"
          title="Browse the duplex wells to which this pool well deconvolutes" /-->
      </ui:define>
    </ss:collapsiblePanel>

    <ss:collapsiblePanel id="otherWellsPanel"
      isCollapsed="#{wellViewer.isPanelCollapsedMap['otherWells']}"
      label="Other Wells With Reagent">
      <ui:define name="content">
        <t:outputText value="No other wells contain this reagent"
          styleClass="label"
          rendered="#{wellViewer.otherWellsDataModel.rowCount == 0}" />
        <t:dataTable id="otherWellsTable" var="reagent"
          value="#{wellViewer.otherWellsDataModel}"
          styleClass="standardTable" columnClasses="column"
          rowClasses="row1,row2" headerClass="tableHeader"
          rendered="#{wellViewer.otherWellsDataModel.rowCount > 0}">
          <t:column>
            <f:facet name="header">
              <t:outputText value="Well" />
            </f:facet>
            <ss:entityLink id="wellEntity" entity="#{reagent.well}"
              viewer="#{wellViewer}" />
          </t:column>
          <t:column>
            <f:facet name="header">
              <t:outputText value="Library Name" />
            </f:facet>
            <ss:entityLink id="libraryEntity"
              entity="#{reagent.well.library}" viewer="#{libraryViewer}"
              property="libraryName" />
          </t:column>
        </t:dataTable>
        <!--h:commandButton value="Browse..."
          action="#{wellViewer.browseOtherWells}" styleClass="command"
          rendered="#{wellViewer.otherWellsDataModel.rowCount > 0}"
          title="Browse the other wells that contain this well's reagent" /-->
      </ui:define>
    </ss:collapsiblePanel>

    <ss:collapsiblePanel id="annotationsPanel" label="Annotations"
      isCollapsed="#{wellViewer.isPanelCollapsedMap['annotations']}">
      <ui:define name="content">

        <t:outputText value="No annotations exist" styleClass="label"
          rendered="#{! wellViewer.annotationListAvailable}" />

        <t:div style="margin-top: 15px; margin-left: 20px;"
          styleClass="annotationTable"
          rendered="#{wellViewer.annotationListAvailable}">
          <ss:nameValueTable id="annotationInfo"
            value="#{wellViewer.annotationNameValueTable}" />
        </t:div>
      </ui:define>
    </ss:collapsiblePanel>
  </h:form>

</ui:composition>

</html>
