<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:t="http://myfaces.apache.org/tomahawk"
	xmlns:s="http://myfaces.apache.org/sandbox"
	xmlns:ss="http://screensaver.med.harvard.edu/ui">


<ui:composition>

	<h:form id="screenResultPanelForm">
		<ss:collapsiblePanel id="screenResultPanel"
			isCollapsed="#{screenResultViewer.isPanelCollapsedMap['screenResultSummary']}"
			label="Screen Result Summary"
			rendered="#{!empty screenResultViewer.screenResult &amp;&amp; !screenResultViewer.screenResult.restricted}">
			<ui:define name="content">
				<t:panelGroup rendered="#{screenResultViewer.editable}">
					<t:commandButton action="#{screenResultViewer.delete}"
						value="Delete"
						onclick="javascript: return confirm('Delete this screen result permanently?');"
						styleClass="command" rendered="#{screenResultViewer.editable}"
						title="Delete the screen results for this screen" />
				</t:panelGroup>

				<t:panelGrid id="screenResultProperties" columns="2"
					columnClasses="propertyLabelColumn,column500"
					styleClass="layoutPanel">

					<ss:property id="screenResultLastImported" label="Last Imported"
						type="Date"
						description="The date the current screen results were loaded into the database"
						value="#{screenResultViewer.screenResult.dateLastImported}" />

					<ss:property id="screenResultIsShareable" label="Shareable"
						type="Boolean"
						description="True when the results are shareable with scientists outside the lab"
						submitOnChange="true"
						value="#{screenResultViewer.screenResult.shareable}" />

					<ss:property id="screenResultPlateCount" label="Plates"
						description="The number of plates for which we have results"
						value="#{screenResultViewer.screenResult.plateNumberCount}" />

					<ss:property id="screenResultReplicateCount" label="Replicates"
						description="The number of replicates screened"
						value="#{screenResultViewer.screenResult.replicateCount}" />

					<ss:property id="screenResultExperimentalWellCount"
						label="Experimental Wells"
						description="The number of experimental wells for which we have results"
						value="#{screenResultViewer.screenResult.experimentalWellCount}" />
				</t:panelGrid>
			</ui:define>
		</ss:collapsiblePanel>

		<ss:collapsiblePanel id="dataHeadersPanel" label="Data Headers"
			isCollapsed="#{screenResultViewer.isPanelCollapsedMap['dataHeadersTable']}"
			rendered="#{!empty screenResultViewer.screenResult &amp;&amp; !screenResultViewer.screenResult.restricted}">
			<ui:define name="content">
				<t:dataTable id="dataHeadersTable"
					value="#{screenResultViewer.dataHeadersTable.dataModel}" var="row"
					styleClass="standardTable" headerClass="tableHeader"
					rowClasses="row1,row2">
					<t:column styleClass="keyColumn">
						<f:facet name="header">
							<t:outputText value="Data Header Name" />
						</f:facet>
						<t:outputText value="#{row.rowLabel}" escape="false"
							styleClass="dataText" title="#{row.rowDescription}" />
					</t:column>
					<t:columns
						value="#{screenResultViewer.dataHeadersTable.columnModel}"
						var="columnName" styleClass="column">
						<f:facet name="header">
							<t:outputText value="#{columnName}" />
						</f:facet>
						<t:outputText
							value="#{screenResultViewer.dataHeadersTable.cellValue}"
							styleClass="dataText" />
					</t:columns>
				</t:dataTable>
			</ui:define>
		</ss:collapsiblePanel>

		<ss:collapsiblePanel id="dataTablePanel"
			isCollapsed="#{screenResultViewer.isPanelCollapsedMap['dataTable']}"
			title="Data"
			rendered="#{!empty screenResultViewer.screenResult &amp;&amp; !screenResultViewer.screenResult.restricted}" />
	</h:form>

	<!-- Warning: wellSearchResultsBody.xhtml must be included outside of h:form elements -->
	<t:div
		rendered="#{!empty screenResultViewer.screenResult &amp;&amp; !screenResultViewer.screenResult.restricted &amp;&amp; ! screenResultViewer.isPanelCollapsedMap['dataTable']}">
		<ui:include src="/libraries/wellSearchResultsBody.xhtml">
			<ui:param name="wellsBrowser"
				value="#{screenResultViewer.resultValueTable}" />
		</ui:include>
	</t:div>

	<h:form id="heatMapsPanelForm">
		<ss:collapsiblePanel id="heatMapsPanel"
			isCollapsed="#{screenResultViewer.isPanelCollapsedMap['heatMaps']}"
			label="Heat Maps"
			rendered="#{!empty screenResultViewer.screenResult &amp;&amp; !screenResultViewer.screenResult.restricted &amp;&amp; ! screenResultViewer.isPanelCollapsedMap['screenResultSummary']}">
			<ui:include src="heatMapViewer.xhtml" />
		</ss:collapsiblePanel>
	</h:form>

	<!-- Warning: screenResultUploader.xhtml must be included outside of h:form elements -->
	<s:roundedDiv borderWidth="4"
		color="#{appInfo.screensaverThemeHeaderColor}" radius="4"
		rendered="#{empty screenResultViewer.screenResult}">
		<t:outputText value="Screen result not available"
			styleClass="transparentSectionHeader" />
	</s:roundedDiv>
	<t:panelGroup
		rendered="#{!screenResultViewer.readOnly &amp;&amp; empty screenResultViewer.screenResult}">
		<ui:include src="admin/screenResultUploader.xhtml" />
	</t:panelGroup>

</ui:composition>

</html>
